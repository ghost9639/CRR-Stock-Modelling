(defmacro append-to-list (target suffix) ;; This is just a practice macro from the first tutorial   "Append SUFFIX to TARGET in place."  `(setq ,target (append ,target ,suffix)));; straight setup (defvar bootstrap-version)(let ((bootstrap-file       (expand-file-name        "straight/repos/straight.el/bootstrap.el"        (or (bound-and-true-p straight-base-dir)            user-emacs-directory)))      (bootstrap-version 7))  (unless (file-exists-p bootstrap-file)    (with-current-buffer        (url-retrieve-synchronously         "https://raw.githubusercontent.com/radian-software/straight.el/develop/install.el"         'silent 'inhibit-cookies)      (goto-char (point-max))      (eval-print-last-sexp)))  (load bootstrap-file nil 'nomessage))(setq straight-use-package-by-default t) ; tells packages to prefer straight.el to package.el(straight-use-package 'use-package)(require 'use-package)(setq use-package-verbose t)(let ((org-dir (expand-file-name "org" data-directory)))  (setq load-path (delete org-dir load-path)))(straight-use-package 'org)(straight-use-package 'org)				; explicitly tells org to load latest org version from straight ;; Pathing(straight-use-package 'exec-path-from-shell)(use-package exec-path-from-shell   :config   (exec-path-from-shell-initialize))(setq auth-sources '("~/.authinfo.gpg" "~/.authinfo" "~/.netrc"));; Generic emacs-wide defaults(save-place-mode 1)						; ensures you open files in the same place you left them(global-auto-revert-mode 1)				; updates buffers whenever they change on disk (setq global-auto-revert-non-file-buffers t)(setq-default tab-width 4)				; defines the length of a standard <tab> to 4 spaces (setq org-clock-persist 'history)		; tells org clock how to work (org-clock-persistence-insinuate)(setq org-clock-into-drawer t)(setq load-prefer-newer t)				;prefer newer versions in your load path (tab-bar-mode 1)						; keeps centaur tabs open(tool-bar-mode -1);; (set-frame-font "")(set-face-attribute 'default nil :family "BigBlueTerm437 Nerd Font") ; font default, delete if annoying;; (set-face-attribute 'default nil :family "MesloLGLDZ Nerd Font") ; font default, delete if annoying;; (set-face-attribute 'default nil :family "ProggyClean CE Nert Font") ; font default, delete if annoying(set-face-attribute 'default nil :height 140)(setq display-line-numbers-type 'relative)							 ; sets the relative line mode ;; (global-display-line-numbers-mode -1)(add-hook 'prog-mode-hook #'display-line-numbers-mode)(add-hook 'text-mode-hook #'display-line-numbers-mode)(setq-default line-move-visual nil)(dolist (mode '(org-mode-hook				vterm-mode-hook				eshell-mode-hook))  (add-hook mode (lambda () (display-line-numbers-mode 0))));; emacs killer (defun server-shutdown ()  "Save buffers, Quit, and Shutdown (kill) server"  (interactive)  (save-some-buffers)  (kill-emacs));; vterm setup(use-package vterm)(use-package vterm-toggle)(global-set-key (kbd "C-`") 'vterm-toggle);; The wonder of GUI(use-package nerd-icons  :straight (nerd-icons             :type git             :host github             :repo "rainstormstudio/nerd-icons.el"             :files (:defaults "data"))  :custom  ;; The Nerd Font you want to use in GUI  ;; "Symbols Nerd Font Mono" is the default and is recommended  ;; but you can use any other Nerd Font if you want  (nerd-icons-font-family "BigBlueTerm437 Nerd Font")  )(use-package doom-themes  :ensure t  :custom  ;; Global settings (defaults)  (doom-themes-enable-bold t)     (doom-themes-enable-italic t)  ;; for treemacs users  (doom-themes-treemacs-theme "doom-colors") ; use "doom-atom" for minimal icon theme  :config  (load-theme 'doom-moonlight t)  ;; Enable flashing mode-line on errors  (doom-themes-visual-bell-config)  ;; Enable custom neotree theme (nerd-icons must be installed!)  (doom-themes-neotree-config)  ;; or for treemacs users  (doom-themes-treemacs-config)  ;; Corrects (and improves) org-mode's native fontification.  (doom-themes-org-config));; Any Customize-based settings go to custom.el or get dumped on boot(setq custom-file "~/.emacs.d/custom.el")(load custom-file 'noerror);; Themes I like:;; doom-solarized-dark-high-contrast;; doom-gruvbox-light;; doom-solarized-light ;; doom-one;; doom-shades-of-purple;; doom-fairy-floss;; doom-vibrant;; doom-dracula;; Treemacs(use-package treemacs  :straight t  :bind  (("C-x t t" . treemacs)                 ("C-x t 1" . treemacs-delete-other-windows))  :config  (treemacs-project-follow-mode t)  (treemacs-follow-mode t)  (treemacs-filewatch-mode t)  (treemacs-git-mode 'deferred)  (setq treemacs-width 30        treemacs-is-never-other-window t))(use-package treemacs-projectile  :ensure t  :after (treemacs projectile))(use-package treemacs-magit  :ensure t  :after (treemacs magit))(use-package treemacs-icons-dired  :ensure t  :after (treemacs))(add-hook 'dired-mode-hook 'treemacs-icons-dired-mode)(global-set-key (kbd "C-x t s o") 'treemacs-select-window)(global-set-key (kbd "C-x t s f") 'treemacs-find-file)(global-set-key (kbd "C-x t s a") 'treemacs-add-project-to-workspace);; centaur tabs;; (use-package centaur-tabs;;   :ensure t;;   :init;;   (setq centaur-tabs-enable-key-bindings t);;   :demand;;   :config;;   (centaur-tabs-mode t);;   (setq centaur-tabs-style "slant");;   (setq centaur-tabs-icon-type 'nerd-icons);;   (setq centaur-tabs-set-bar 'left);;   (setq centaur-tabs-set-modified-marker t);;   (centaur-tabs-group-by-projectile-project);;   )(global-set-key (kbd "C-c t n") 'tab-bar-new-tab)(global-set-key (kbd "C-c t k") 'tab-bar-close-tab)(global-set-key (kbd "C-c t 0") 'tab-bar-close-other-tabs)(global-set-key (kbd "C-c t t") 'tab-bar-switch-to-tab)(global-set-key (kbd "C-x t j") 'tab-previous)(global-set-key (kbd "C-x t k") 'tab-next);; (centaur-tabs-change-fonts ) if it won't play nicely with blueterm;; (use-package lilypond;;   :ensure t);; windmove(use-package windmove  :ensure nil  :bind*  (("M-<left>" . windmove-left)   ("M-<right>" . windmove-right)   ("M-<up>" . windmove-up)   ("M-<down>" . windmove-down)));; ace-window(use-package ace-window  :ensure t  :config  (setq aw-keys '(?a ?s ?d ?f ?g ?h ?j ?k ?l))  (setq aw-ignore-current nil))(global-set-key (kbd "M-o") 'ace-window)(global-unset-key (kbd "C-x 0"))(global-set-key (kbd "C-x 0") 'ace-delete-window);;OS specific stuff(defconst *is-a-mac* (eq system-type 'darwin))(global-set-key (kbd "M-3") '(lambda() (interactive) (insert "#")))(when *is-a-mac*  (setq mac-command-modifier 'meta)  (setq mac-right-command-modifier 'meta)  (setq mac-option-modifier 'super)  (setq mac-ns-modifier 'hyper)  (setq native-comp-compiler "clang")  (setq native-comp-driver-options '("-O2" "-pipe"))  (setq default-input-method "MacOSX"));; Fullscreen by default(add-to-list 'default-frame-alist '(fullscreen . fullboth));; ivy replacements(use-package vertico  :init  (vertico-mode))(use-package marginalia  :ensure t  :init  (marginalia-mode))(use-package consult  :ensure t  :bind (("C-s" . consult-line)         ("C-x b" . consult-buffer)         ("M-y" . consult-yank-pop)));; consult directory (shows open directories)(use-package consult-dir  :ensure t  :bind (("C-x C-d" . consult-dir)));; projectile does a lot to help with searching across and between projects(use-package projectile  :init  (projectile-mode t) ;;enables immediately  :bind-keymap  ("C-c p" . projectile-command-map)  :config  (setq projectile-enable-caching t   ;;optimisations		projectile-completion-system 'default)) ;; maintains minibuffer(with-eval-after-load 'projectile  (define-key projectile-command-map (kbd "C-c p s r") 'consult-ripgrep)  (define-key projectile-command-map (kbd "C-c p s f") 'consult-ripgrep))(global-set-key (kbd "C-c f") 'consult-ripgrep);; supplies consult searching to projectile (use-package consult-projectile  :after (projectile consult)  :ensure t);; let cmake know what to do(defun my/setup-cmake-c-mode ()  "Set Projectile compile/run commands for C/C++ projects."  (setq-local projectile-project-compilation-cmd "cmake --build build")  (setq-local projectile-project-run-cmd "./build/App"))(defun my/setup-java-gradle-mode ()  "Set Projectile compile/run commands for Java projects using Gradle."  (setq-local projectile-project-compilation-cmd "./gradlew :app:run")  (setq-local projectile-project-run-cmd "./gradlew :app:run"));; c treesitter hooks(add-hook 'c-mode-hook #'my/setup-cmake-c-mode)(add-hook 'c++-mode-hook #'my/setup-cmake-c-mode)(add-hook 'c-ts-mode-hook #'my/setup-cmake-c-mode)(add-hook 'c++-ts-mode-hook #'my/setup-cmake-c-mode)(add-hook 'java-ts-mode-hook #'my/setup-java-gradle-mode);; manual rg(grep-apply-setting 'grep-find-command '("rg -n -H --no-heading -e '' $(git rev-parse --show-toplevel || pwd)" . 27))(global-set-key (kbd "C-x r C-g") 'grep-find);; CoRFu (Completion in Region Function)(use-package corfu  :ensure t  :custom  (corfu-auto t)  (corfu-auto-delay 0.1)  (corfu-auto-prefix 1)  (corfu-cycle t)  (corfu-preselect 'prompt)    (corfu-history-mode 1)  (corfu-indexed-mode 1)  (corfu-echo-mode 1)  (corfu-popupinfo-mode 1)  :init  (global-corfu-mode))(global-set-key (kbd "M-q") 'corfu-quick-complete)(global-set-key (kbd "C-q") 'corfu-quick-insert);; Cape provides capf backends to CoRFu(use-package cape 						  :ensure t  :init  (add-hook 'prog-mode-hook            (lambda ()              (add-to-list 'completion-at-point-functions #'cape-dabbrev t)              (add-to-list 'completion-at-point-functions #'cape-file t))))(setq completion-category-overrides      '((file (styles partial-completion))        (buffer (styles basic))        (consult-location (styles basic))        (consult-grep (styles basic))        (consult-xref (styles basic))        (consult-line (styles basic))));; orderless finds completions(use-package orderless  :ensure t  :custom  (completion-styles '(orderless basic))  (completion-category-defaults nil)  (completion-category-overrides   '((file (styles partial-completion))     (buffer (styles basic))     (consult-location (styles basic))     (consult-grep (styles basic))     (consult-xref (styles basic))     (consult-line (styles basic)))));; embark lets you do more with corfu autocompletions(use-package embark						  :ensure t  :bind  (("C-." . embark-act)           ("M-." . embark-dwim)))    (use-package embark-consult  :ensure t  :hook  (embark-collect-mode . consult-preview-at-point-mode));; CoRFu GUI(use-package nerd-icons-corfu  :ensure t  :after (corfu nerd-icons)  :config  ;; Add its formatter so that Corfu shows icons in the margin  (add-to-list 'corfu-margin-formatters #'nerd-icons-corfu-formatter)  ;; Optionally customize the mapping  (setq nerd-icons-corfu-mapping        '((array :style "cod" :icon "symbol_array" :face font-lock-type-face)          (boolean :style "cod" :icon "symbol_boolean" :face font-lock-builtin-face)          (file :fn nerd-icons-icon-for-file :face font-lock-string-face)          ;; Fallback — this is used when no specific kind is matched:          (t :style "cod" :icon "code" :face font-lock-warning-face))));; npm (use-package npm  :ensure t);; lets you know what else you can do after waving C+x around(use-package which-key  :ensure t  :config  (which-key-mode));; helpful module(use-package helpful  :ensure t);; magit my beloved(use-package magit  :ensure t);; smartparens angle or debil (use-package smartparens  :ensure t  :config  (require 'smartparens-config)  (smartparens-global-mode 1));; Tramp is useful for connecting to emacs across different devices;; SolverPi access:;; /ssh:SolverPi:/ssd/mount/pi-home;; then all files are accessible;; Pi code for login is: wifi + new bank;; C-x k ends TRAMP connection;; debian debianserver lenovo homeserver;; path is: ssh:/debianserver:/home/rg;; 100.73.206.44(use-package tramp  :ensure t);; treesitter meaningfully parses types(use-package treesit-auto  :custom  (treesit-auto-install 'prompt) ;; prompts to install missing treesitter grammar  :config  (setq treesit-language-source-alist        '((java "https://github.com/tree-sitter/tree-sitter-java")          (r "https://github.com/r-lib/tree-sitter-r")          ;;(cmake "https://github.com/Symbitic/tree-sitter-cmake")          (c "https://github.com/tree-sitter/tree-sitter-c")          (json "https://github.com/tree-sitter/tree-sitter-json")          (cpp "https://github.com/tree-sitter/tree-sitter-cpp")          (rust "https://github.com/tree-sitter/tree-sitter-rust")          (python "https://github.com/tree-sitter/tree-sitter-python")          (go "https://github.com/tree-sitter/tree-sitter-go")		  (nix "https://github.com/nix-community/tree-sitter-nix")		  (haskell "https://github.com/tree-sitter/tree-sitter-haskell")          (ruby "https://github.com/tree-sitter/tree-sitter-ruby")))  (setq treesit-auto-add-to-auto-mode-alist '(all))  ;; This line explicitly tells Emacs to activate Treesitter for these languages.  (setq treesit-auto-langs '(cpp java python c haskell)));; folding behaviour(use-package treesit-fold  :straight (treesit-fold :type git :host github :repo "emacs-tree-sitter/treesit-fold")  :config  (global-treesit-auto-mode)  )(global-set-key (kbd "C-c t f c") 'treesit-fold-close)(global-set-key (kbd "C-c t f o") 'treesit-fold-open-all)(add-to-list 'load-path "~/emacs-util-libs");;(require treesit-fold)(setq gc-cons-threshold 100000000) ;; 100MB(setq read-process-output-max (* 1024 1024 1024)) ;; 1MB(setq lsp-log-io nil)(setq lsp-modeline-diagnostics-enable nil)(setq lsp-modeline-code-actions-enable nil)(setq lsp-java-trace-server "messages") ;; or "verbose" for full;; lsp-mode(use-package lsp-mode  :ensure t  :hook ((java-mode . lsp)	 (c++-mode . lsp)	 (c-mode . lsp)	 (haskell-mode . lsp))  :custom  (lsp-completion-provider :capf)  (lsp-enable-snippet nil)  (lsp-idle-delay 0.7)  :commands lsp  :config  (add-hook 'c++-mode-hook #'lsp)  (add-hook 'c-mode-hook #'lsp)  (add-hook 'julia-mode-hook #'lsp)  (add-hook 'python-mode-hook #'lsp))(setq lsp-prefer-capf t)(setq lsp-eldoc-enable-hover nil)(setq lsp-signature-auto-activate nil)(setq lsp-signature-render-documentation nil)(add-hook 'flymake-mode-hook          (lambda ()            (setq-local next-error-function #'flymake-goto-next-error)))(with-eval-after-load 'flymake  (define-key flymake-mode-map (kbd "M-n") #'flymake-goto-next-error)  (define-key flymake-mode-map (kbd "M-p") #'flymake-goto-prev-error))(global-set-key (kbd "C-x `") 'consult-flymake)(use-package lsp-java  :ensure t  :after lsp  :custom  (lsp-java-workspace-dir "~/.emacs.d/workspace/")  (lsp-java-workspace-cache-dir   (lambda (project-root)     (expand-file-name      (md5 (file-truename project-root))      lsp-java-workspace-dir))))  ;; me when  I have to deactivate all of my helper functions because I'm bored(with-eval-after-load 'lsp-mode  (setq lsp-enable-file-watchers nil)  (setq lsp-enable-symbol-highlighting nil)  (setq lsp-signature-auto-activate nil)  (setq lsp-enable-on-type-formatting nil)  (setq lsp-lens-enable nil)  (setq lsp-before-save-edits nil))(setq lsp-java-vmargs      '("-Xmx2G"        "-XX:+UseStringDeduplication"        "-Dlog.level=ERROR"))(setq lsp-java-import-gradle-enabled t)(setq lsp-java-import-maven-enabled nil)(setq lsp-java-save-action-organize-imports nil)(setq lsp-java-completion-enabled t) 	; autocomplete is for speds tbh(setq lsp-java-import-gradle-wrapper-enabled t)(add-to-list 'major-mode-remap-alist '(java-mode . java-ts-mode))(add-hook 'java-ts-mode-hook #'lsp)(with-eval-after-load 'lsp-mode  (require 'cape)  (defun my/lsp-corfu-orderless-and-refresh ()    "Make Orderless apply to LSP completions and force refresh as you type."    ;; 1) Ensure Orderless is actually used for the 'lsp-capf category.    (setq-local completion-category-overrides completion-category-overrides)    (setf (alist-get 'lsp-capf completion-category-overrides)          '(styles orderless basic))    ;; 2) Replace lsp-mode's capf with a buster-wrapped one (fixes stale candidates).    (setq-local completion-at-point-functions                (cons (cape-capf-buster #'lsp-completion-at-point)                      (remove #'lsp-completion-at-point completion-at-point-functions))))  (add-hook 'lsp-completion-mode-hook #'my/lsp-corfu-orderless-and-refresh))(use-package dap-mode  :ensure t  :after lsp-mode  :config  (dap-auto-configure-mode)  (require 'dap-java)  (require 'dap-lldb)  (require 'dap-julia)  ;; Only configure LLDB templates on macOS  (when (eq system-type 'darwin)    (dap-register-debug-template "C/C++ LLDB :: App"      (list :type "lldb"            :request "launch"            :name "LLDB::App"            :program "${workspaceFolder}/build/App"            :cwd "${workspaceFolder}"            :stopOnEntry t            :args nil            :environment-variables nil            :externalConsole nil))))(when (eq system-type 'darwin)  (global-set-key (kbd "C-c b")                  (lambda ()                    (interactive)                    (dap-debug (dap--debug-template-config "C/C++ LLDB :: App")))));; (Use-package yasnippet   ;; old;;   :ensure t;;   :hook (prog-mode . yas-minor-mode);;   )(use-package yasnippet  :ensure t  :config  (yas-global-mode 1))(use-package yasnippet-snippets  :ensure t)(use-package lsp-ui  :ensure t  :after lsp  :custom  (lsp-ui-doc-enable t)  (lsp-ui-sideline-enable t)  (lsp-ui-sideline-show-code-actions t)  (lsp-ui-sideline-show-hover t));; nix(use-package nix-mode  :hook (nix-mode . lsp-deferred)  :ensure t)(use-package nix-ts-mode  :hook (nix-mode)  :ensure t)(use-package org-nix-shell  :ensure t)(use-package ob-nix  :ensure t)(use-package lsp-ltex  :ensure t  ;; :hook ((org-mode . (lambda ()  ;;                      (require 'lsp-ltex)  ;;                      (lsp-deferred))))  :init  (setq lsp-ltex-version "16.0.0"        lsp-ltex-language "en-GB"        lsp-ltex-disabled-rules "{\"en-GB\": [\"MORFOLOGIK_RULE_EN_GB\"]}"));; org mode setups(setq org-modules nil)(setq load-path (remove (expand-file-name "org" data-directory) load-path))(straight-use-package 'org);; org configs(use-package org  :straight t  :mode ("\\.org\\'" . org-mode)  :init  ;; Files to include in agenda  (setq org-agenda-files '("~/org/todos.org" "~/org/notes.org" "~/org/projects.org" "~/org/orgfile.org" "~/org/calendar.org"))  (setq org-log-done 'time)  (setq org-return-follows-link t)  (setq org-hide-emphasis-markers t)  :config  ;; Hooks  (add-hook 'org-mode-hook 'org-indent-mode)  (add-hook 'org-mode-hook 'visual-line-mode)  ;; Org mode keybindings  (define-key org-mode-map (kbd "C-c <up>") 'org-priority-up)  (define-key org-mode-map (kbd "C-c <down>") 'org-priority-down)  (define-key org-mode-map (kbd "C-c C-g C-r") 'org-shiftmetaright)  (define-key org-mode-map (kbd "C-c u") 'consult-org-heading)  ;; Global keybindings  (define-key global-map "\C-cl" 'org-store-link)  (define-key global-map "\C-ca" 'org-agenda)  (define-key global-map "\C-cc" 'org-capture)  ;; Babel setup for R   (org-babel-do-load-languages   'org-babel-load-languages   '((R . t)	 (C . t)     (emacs-lisp . t)	 (julia . t)	 (haskell . t)	 (python . t)))  (setq org-confirm-babel-evaluate nil)) ;; don't prompt before evaluating R(setq org-babel-python-command "python3")(setq org-babel-haskell-command "runhaskell")(use-package org-alert  :ensure t  :config  (org-alert-enable)  (setq alert-default-style 'libnotify)  (setq org-alert-notify-cutoff 10		org-alert-notify-after-event-cutoff 10))(use-package org-download  :ensure t  :after org  :hook (dired-mode . org-download-enable)  :bind (:map org-mode-map              ("C-c y" . org-download-clipboard)));; capture templates in org mode (setq org-capture-templates      '(            ("j" "Work Log Entry"     ;; triggers if j is typed         entry (file+datetree "~/org/work-log.org")         "* %?"         :empty-lines 0)		("n" "Note"         entry (file+headline "~/org/notes.org" "Random Notes")         "** %?"         :empty-lines 0)	("g" "General To-Do"         entry (file+headline "~/org/todos.org" "General Tasks")         "* TODO [#B] %?\n:Created: %T\n "         :empty-lines 0)        ));; TODO states(setq org-todo-keywords      '((sequence "TODO(t)" "PLANNING(p)" "IN-PROGRESS(i@/!)" "VERIFYING(v!)" "BLOCKED(b@)"  "|" "DONE(d!)" "OBE(o@!)" "WONT-DO(w@/!)" )        ));; TODO colors(setq org-todo-keyword-faces      '(        ("TODO" . (:foreground "GoldenRod" :weight bold))        ("PLANNING" . (:foreground "DeepPink" :weight bold))        ("IN-PROGRESS" . (:foreground "Cyan" :weight bold))        ("VERIFYING" . (:foreground "DarkOrange" :weight bold))        ("BLOCKED" . (:foreground "Red" :weight bold))        ("DONE" . (:foreground "LimeGreen" :weight bold))        ("OBE" . (:foreground "LimeGreen" :weight bold))        ("WONT-DO" . (:foreground "LimeGreen" :weight bold))        ))(setq org-agenda-start-on-weekday nil)   (setq org-agenda-span 'day)              (setq org-agenda-show-log t)              (setq org-agenda-time-grid      '((daily today require-timed)        (800 1000 1200 1400 1600 1800 2000)        " ┄┄┄┄┄ "        "┄┄┄┄┄"))(global-set-key (kbd "C-c m a") 'consult-org-agenda);; Calendar export(use-package oauth2  :straight (oauth2             :type git             :host github             :repo "rayslava/oauth2"             ;; :files ("oauth2.el")			 ))(use-package auth-source-xoauth2-plugin  :ensure t)(use-package json  :ensure t)(use-package plstore  :straight t  :demand t)(use-package url-http-oauth  :straight t  :demand t);; caldav(defun my/auth-source-get-oauth2 (host)  "Return (CLIENT_ID CLIENT_SECRET) from auth-source for HOST."  (require 'auth-source)  (let* ((match (car (auth-source-search                      :host host                      :require '(:user :secret)                      :max 1)))         (client-id (plist-get match :user))         (client-secret (plist-get match :secret)))    (when (functionp client-secret)      (setq client-secret (funcall client-secret)))    (unless (and client-id client-secret)      (error "No auth-source entry for host %s" host))    (list client-id client-secret)))(use-package org-caldav  :straight t  :after oauth2  :config  (require 'ox-icalendar)  (let* ((creds (my/auth-source-get-oauth2 "org-caldav-google-oauth"))         (client-id (nth 0 creds))         (client-secret (nth 1 creds)))    (setq org-caldav-url 'google          org-caldav-oauth2-client-id client-id          org-caldav-oauth2-client-secret client-secret))  (setq org-caldav-calendar-id "thewanderingghost9639@gmail.com"        org-caldav-inbox "~/org/calendar.org"        org-caldav-files '("~/org/todos.org" "~/org/projects.org" "~/org/notes.org")        org-icalendar-timezone "Europe/London"        org-icalendar-store-UID t))(global-set-key (kbd "C-c m c") 'org-caldav-sync);; org-roam (use-package org-roam  :ensure t  :init  (setq org-roam-v2-ack t)  :custom  (org-roam-directory "~/OrgRoam")  :bind (("C-c n l" . org-roam-buffer-toggle)         ("C-c n f" . org-roam-node-find)         ("C-c n g" . org-roam-graph)         ("C-c n i" . org-roam-node-insert)         ("C-c n c" . org-roam-capture)         ;; Dailies         ("C-c n j" . org-roam-dailies-capture-today))  :config  ;; If you're using a vertical completion framework, you might want a more informative completion interface  (setq org-roam-node-display-template (concat "${title:*} " (propertize "${tags:10}" 'face 'org-tag)))  (org-roam-db-autosync-mode)  ;; If using org-roam-protocol  (require 'org-roam-protocol))(global-set-key (kbd "C-c C-x k") 'org-link-preview-clear)(setq org-startup-with-inline-images nil)  (setq package-enable-at-startup nil) (use-package pandoc  :ensure t)(use-package org-ref  :ensure t) (use-package pdf-tools   :ensure t   :config   (pdf-tools-install))(add-hook 'pdf-view-mode-hook #'auto-revert-mode)(add-hook 'pdf-view-mode-hook #'pdf-view-midnight-minor-mode)(setq pdf-info-loglevel 'debug)(use-package citar						  :custom  (citar-bibliography '("~/bib/references.bib"))  (org-cite-global-bibliography '("~/bib/references.bib"))  (org-cite-insert-processor 'citar)  (org-cite-follow-processor 'citar)  (org-cite-activate-processor 'citar)  (citar-bibliography org-cite-global-bibliography)  :hook  (LaTeX-mode . citar-capf-setup)  (org-mode . citar-capf-setup))(global-set-key (kbd "C-c M-c") 'citar-insert-citation)(setq org-cite-global-bibliography '("~/bib/references/bib"))(use-package citar-embark				; really is just citations just changes embark for citation completions lol  :after (citar embark)  :no-require  :config (citar-embark-mode))(use-package tikz  :ensure t)(use-package auctex  :ensure t  :defer t) (setq org-latex-create-formula-image-program 'dvisvgm)(setq org-preview-latex-default-process 'dvisvgm)(setq org-format-latex-options      (plist-put org-format-latex-options :scale 1.5)) ;; Adjust for readability(setq org-latex-compiler "lualatex")(setq org-latex-pdf-process      '("latexmk -pdf -lualatex -shell-escape -interaction=nonstopmode -synctex=1 -outdir=%o %f"))(setq org-latex-listings 'listings)(setq org-cite-global-bibliography '("~/bib/references.bib"));;(setq org-preview-latex-default-process 'dvisvgm)(setq org-preview-latex-process-alist      '((dvisvgm :programs ("latex" "dvisvgm")                 :description "dvi > svg"                 :message "You need to install the programs: latex and dvisvgm."                 :use-xcolor t                 :image-input-type "dvi"                 :image-output-type "svg"                 :image-size-adjust (1.7 . 1.5)                 :latex-compiler ("latex -interaction nonstopmode -output-directory %o %f")                 :image-converter ("dvisvgm %f -n -b min -c %S -o %O"))));; org custom classes(add-to-list 'org-latex-classes '("article-lua"   "\\documentclass[a4paper]{article}\\usepackage{fontspec}\\setmainfont{Times New Roman}[Ligatures=TeX]\\usepackage{amsmath}\\usepackage{float}\\usepackage[mathrm=sym]{unicode-math}\\usepackage{xcolor}\\usepackage{graphicx}\\usepackage{hyperref}\\usepackage{listings}\\lstset{  backgroundcolor=\\color{gray!10},  basicstyle=\\ttfamily\\small,  breaklines=true,  showspaces=false,  showstringspaces=false}"   ("\\section{%s}" . "\\section*{%s}")   ("\\subsection{%s}" . "\\subsection*{%s}")   ("\\subsubsection{%s}" . "\\subsubsection*{%s}")))(setenv "PATH" (concat "~/.wrapfig-store:"					   (getenv "PATH")))(add-to-list 'exec-path "~/.wrapfig-store/");; org easydraw(straight-use-package '(edraw :type git :host github :repo "misohena/el-easydraw"))(setq edraw-org-export-format 'svg)(setq edraw-org-export-directory "./edraw-export");; Configure edraw with Org(use-package edraw  :after org  :config  (require 'edraw-org)  (edraw-org-setup-default))(autoload 'edraw-mode "edraw-mode")(add-to-list 'auto-mode-alist '("\\.edraw\\.svg$" . edraw-mode));; C++ setup(use-package cmake-ide  :after (lsp-mode)  :init  (add-hook 'cmake-ide-build-hook #'lsp-enable-on-compile)    :config   (cmake-ide-setup))(add-hook 'prog-mode-hook #'hs-minor-mode)(define-key prog-mode-map (kbd "C-c h") 'hs-toggle-hiding)(define-key prog-mode-map (kbd "C-c H") 'hs-hide-all)(define-key prog-mode-map (kbd "C-c S") 'hs-show-all)(setq lsp-clients-clangd-executable "/usr/bin/clangd")(add-hook 'c++-mode-hook #'treesit-major-mode)(add-to-list 'major-mode-remap-alist '(c++-mode . c++-ts-mode))(setq lsp-clients-clangd-args '("-compile-commands-dir" "/path/to/build"));; lldb (for mac);; (use-package realgud;;   :ensure t);; (use-package realgud-lldb;;   :ensure t;;   :after realgud);; (add-hook 'realgud--lldb-mode-hook 'realgud-track-mode);; (global-set-key (kbd "C-c g") 'realgud--lldb);; nov mode(use-package nov  :ensure t  );; ESS: Emacs Speaks Statistics - R term(use-package ess :ensure t :init (require 'ess-site) :config (setq ess-indent-offset 2      ;; common for tidyverse style       ess-eval-visibly 'nowait ;; don't freeze Emacs while evaluating       ess-ask-for-ess-directory nil) ;; don't ask for working directory );; .rmd enabler(use-package polymode  :ensure t)(use-package poly-R  :ensure t)(use-package poly-markdown  :ensure t)(add-to-list 'auto-mode-alist '("\\.Rmd\\'" . poly-markdown+r-mode));; haskell configs(use-package haskell-mode  :ensure t)(use-package lsp-haskell  :ensure t)(let ((ghcup (expand-file-name "~/.ghcup/bin"))      (cabal (expand-file-name "~/.cabal/bin")))  (setenv "PATH" (concat ghcup ":" cabal ":" (getenv "PATH")))  (add-to-list 'exec-path ghcup)  (add-to-list 'exec-path cabal));; (setq lsp-haskell-server-path "~/.ghcup/hls/2.10.0.0/bin/haskell-language-server-9.12.2");; Tidal configs (although most stored in ~/tidal/tidal.el)(setq load-path (cons "~/tidal/" load-path))(require 'tidal)(setq tidal-interpreter "~/.ghcup/bin/ghci")(setq tidal-boot-script-path "~/.local/state/cabal/store/ghc-9.12.2-inplace/tdl-1.10.1-e4b0e05c/share/BootTidal.hs");; tell tidal.el to use the global installed library(setq tidal-interpreter-arguments '("-ignore-dot-ghci" "-XOverloadedStrings" "-XFlexibleContexts" "-XNoMonomorphismRestriction"));; Optional: force tidal.el not to look for a cabal project(setq tidal-default-target "localhost:6010");; Python configs(use-package pyvenv  :ensure t  :config  (pyvenv-mode 1));; jinx spellchecker (use-package jinx  :straight t  :hook (after-init . global-jinx-mode)  :bind (("M-$" . jinx-correct)               ("C-M-$" . jinx-languages))  :custom  (jinx-languages "en_GB"))(global-set-key (kbd "C-$ n") 'jinx-next)(global-set-key (kbd "C-$ p") 'jinx-previous)(global-set-key (kbd "C-$ c") 'jinx-correct);; fancy battery settings(use-package fancy-battery  :ensure t  :config  (setq fancy-battery-show-percentage t)  (fancy-battery-mode 1))(add-hook 'after-init-hook #'fancy-battery-mode)(global-set-key (kbd "C-c m b") 'battery);; multiple cursors(use-package multiple-cursors  :ensure t);; marks region (global-set-key (kbd "C-M-c") 'mc/edit-lines);; marks word (global-set-key (kbd "C->") 'mc/mark-next-like-this)(global-set-key (kbd "C-<") 'mc/mark-previous-like-this)(global-set-key (kbd "C-c C-<") 'mc/mark-all-like-this);; gnupg encryption stuff (use-package pinentry  :ensure t  :init  (pinentry-start));; (setq epg-pinentry-mode 'loopback);; email client(require 'mu4e)							; nix manages mu4e load path(setq mu4e-context-policy 'ask-if-none)(setq mu4e-compose-context-policy 'ask)(setq native-comp-jit-compilation nil)(setq native-comp-async-report-warnings-errors nil)(setq mu4e-maildir (expand-file-name "~/mail"))(setq mu4e-contexts      (list       (make-mu4e-context        :name "rghosh9639"        :match-func        (lambda (msg)          (when msg            (string-prefix-p             (expand-file-name "~/mail/account1/")             (mu4e-message-field msg :path))))        :vars `((user-mail-address  . "rghosh9639@gmail.com")                (user-full-name     . "R")                (mu4e-sent-folder   . "/account1/[Gmail].Sent Mail")                (mu4e-drafts-folder . "/account1/[Gmail].Drafts")                (mu4e-trash-folder  . "/account1/[Gmail].Trash")                (mu4e-refile-folder . "/account1/[Gmail].All Mail")))       (make-mu4e-context        :name "thewanderingghost9639"        :match-func        (lambda (msg)          (when msg            (string-prefix-p             (expand-file-name "~/mail/account2/")             (mu4e-message-field msg :path))))        :vars `((user-mail-address  . "thewanderingghost9639@gmail.com")                (user-full-name     . "R")                (mu4e-sent-folder   . "/account2/[Gmail].Sent Mail")                (mu4e-drafts-folder . "/account2/[Gmail].Drafts")                (mu4e-trash-folder  . "/account2/[Gmail].Trash")                (mu4e-refile-folder . "/account2/[Gmail].All Mail")))))(setq sendmail-program "/run/current-system/sw/bin/msmtp")(setq send-mail-function 'sendmail-send-it      message-send-mail-function 'sendmail-send-it      mail-specify-envelope-from t      message-sendmail-envelope-from 'header)(setq mu4e-get-mail-command "offlineimap -o -q")(defvar my-mu4e-auto-update-timer nil)(defun my-mu4e-start-auto-update ()  (interactive)  (when my-mu4e-auto-update-timer    (cancel-timer my-mu4e-auto-update-timer))  (setq my-mu4e-auto-update-timer        (run-with-timer 0 300                        (lambda ()                          (when (fboundp 'mu4e-update-mail-and-index)                            (mu4e-update-mail-and-index t))))))(global-set-key (kbd "C-c o e") 'mu4e);; verilog(straight-use-package 'verilog-mode)(use-package verilog-mode  :ensure t)(defun duplicate-line()  "Duplicate line below, preserving indentation"  (interactive)							; lets us call the function ourselves  (let (start end)						; declares start and end as variables for use 	(save-excursion	  (beginning-of-line)	  (setq start (point))	  (end-of-line)	  (setq end (point)))	(copy-region-as-kill start end)	(end-of-line)	(newline)	(yank)	(indent-for-tab-command)))(global-set-key (kbd "C-; y") 'duplicate-line);; Julia(straight-use-package 'julia-mode)(use-package julia-mode  :ensure t  :config  (define-key julia-mode-map (kbd "TAB") 'julia-latexsub-or-indent))(with-eval-after-load 'ess-site  (setq auto-mode-alist        (rassq-delete-all 'ess-julia-mode auto-mode-alist)))(add-to-list 'auto-mode-alist '("\\.jl\\'" . julia-mode))(with-eval-after-load 'lsp-mode  (defun my/julia-capf-setup ()    ;; Make LSP candidates go through orderless (optional; switch to basic if it filters too hard)    (setf (alist-get 'lsp-capf completion-category-overrides)          '(styles orderless basic))    ;; Put LSP completion FIRST so it wins, keep latexsub afterwards    (setq-local completion-at-point-functions                (list (cape-capf-buster #'lsp-completion-at-point)                      #'julia-mode-latexsub-completion-at-point-around                      #'julia-mode-latexsub-completion-at-point-before                      #'cape-file                      #'cape-dabbrev)))  (add-hook 'julia-mode-hook #'my/julia-capf-setup))(use-package lsp-julia  :ensure t  :init  (setq lsp-julia-package-dir nil)  (setq lsp-julia-flags		(list (concat "-J" (expand-file-name "~/.julia/sysimages/languageserver.dylib"))))  :config  (setq lsp-julia-default-environment "~/.julia/environments/v1.7"))(use-package julia-repl  :ensure t)(with-eval-after-load 'julia-repl  (add-hook 'julia-mode-hook #'julia-repl-mode));; disk usage (use-package disk-usage  :ensure t);; Ultra Scroll(use-package ultra-scroll  :ensure t  :init  (setq scroll-conservatively 3		scroll-margin 0)  :config  (ultra-scroll-mode 1));; Experimental Section(defun full/authinfo-call (host login &optional port)  "Pulls secret given host and login"  (let* ((matches (auth-source-search                   :host host                   :user login                   :port port                   :require '(:secret)                   :max 1))         (entry (car matches))         (secret (plist-get entry :secret)))    (when secret      (if (functionp secret) (funcall secret) secret))));; smudge (straight-use-package 'smudge)(use-package smudge  :bind-keymap ("C-c ." . smudge-command-map)  :custom  (smudge-oauth2-client-secret (full/authinfo-call "spotify" "pass" 8080))  (smudge-oauth2-client-id (full/authinfo-call "spotify" "clientid" 8080))  ;; optional: enable transient map for frequent commands  (smudge-player-use-transient-map t)  :config  ;; optional: display current song in mode line  (global-smudge-remote-mode))(setq smudge-oauth2-client-secret (full/authinfo-call "spotify" "pass" 8080))(setq smudge-oauth2-client-id (full/authinfo-call "spotify" "clientid" 8080))(setq smudge-transport 'connect)(setq smudge-player-status-refresh-interval 10)(setq smudge-status-location 'title-bar)(setq smudge-title-bar-separator "----")